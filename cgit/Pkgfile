# Description: Git web interface written in C
# URL: http://hjemli.net/git/cgit/
# Maintainer: Lucas Hazel, lucas@die.net.au

# Depends on: git

name=cgit
version=master
release=2
source=()

build() {
	cd $PKGMK_SOURCE_DIR
	
	if [ -d $name ]; then
		(cd $name; git pull)
	else
		git clone git://hjemli.net/pub/git/$name
	fi
	
	if [ -d git ]; then
		(cd git; git pull)
	else
		git clone git://git.kernel.org/pub/scm/git/git.git
	fi
	cp -r $name $SRC/
	
	cp -r git $SRC/$name/
	cd $SRC/$name/git
	git checkout v`prt-get printf %v --filter=git`
	
	cd $SRC/$name
	git checkout $version
	
	sed -i "s|/var/www/htdocs|$PKG&|" Makefile
	
	make
	make install
	
	install -D cgitrc $PKG/etc/cgitrc
}
